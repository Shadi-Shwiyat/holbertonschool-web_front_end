<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>

        <meta charset="utf-8" />
        <title>Task 10</title>

        <!-- Loading jQuery CDN -->
        <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    </head>

    <body>
        <!-- jQuery Scripting -->
        <script type="application/javascript">
            // Loading function when document is ready
            $(function() {
                // Adding passed in data to paragraph on body
                function addPostRow (data) {
                    // Setting up variables for paragraph with span
                    let paragraph = $('<p>');
                    let ID = data.id;
                    let TITLE = data.title;
                    let AUTHOR = data.author;
                    console.log(ID, TITLE, AUTHOR);
                    let span = $('<span>').text(`Post created with id ${ID}, title: ${TITLE}, author: ${AUTHOR}`);

                    // Appending paragraph to body
                    paragraph.append(span);
                    $('body').append(paragraph);
                }

                // Makes get request to path of posts
                function listPosts () {
                    $.get('http://localhost:3000/posts', (data, status) => {
                        console.log(status);
                        if (status == 'success') {
                            $.each(data, (index, dataItem) => {
                                addPostRow(dataItem);
                            })
                        } else {
                            alert('Server Error');
                        }
                    });
                }

                listPosts();
            });
        </script>
    </body>
</html>